import{s as u,S as l,c as g,p as I}from"./index-2-HCTc4e.js";import{openModal as v}from"./planejamento-diario-GX6Pjrzf.js";import{G as D}from"./goalManager-C8P1f7jB.js";import"./ai-BOEkcp8J.js";let i=[],f=null,m=null;const S=[{id:"financeira-1",text:"Registrar todas as despesas do dia",completed:!1},{id:"financeira-2",text:"Revisar o orçamento semanal e ajustar se necessário",completed:!1},{id:"financeira-3",text:"Transferir valor para a reserva de emergência",completed:!1},{id:"financeira-4",text:"Estudar por 15 minutos sobre um tipo de investimento (ex: Tesouro Selic)",completed:!1}],e={pageContainer:null,assetList:null,assetForm:null,assetNameInput:null,assetPurchaseDateInput:null,assetModal:null,assetModalForm:null,assetModalCloseBtn:null,assetModalCancelBtn:null,saveAssetEditBtn:null,assetNameEditInput:null,assetPurchaseDateEditInput:null,reflectionForm:null},p=()=>{if(e.assetList){if(e.assetList.innerHTML="",i.length===0){e.assetList.innerHTML='<tr><td colspan="4" class="empty-list-placeholder">Nenhum item adicionado.</td></tr>';return}i.forEach(t=>{const n=new Date(t.purchaseDate+"T00:00:00"),s=new Date(n);s.setFullYear(s.getFullYear()+7);const a=document.createElement("tr");a.dataset.id=t.id,a.innerHTML=`
            <td>${I.sanitize(t.name)}</td>
            <td>${n.toLocaleDateString("pt-BR")}</td>
            <td>${s.toLocaleDateString("pt-BR")}</td>
            <td class="item-actions">
                <button class="action-btn edit-asset-btn edit" aria-label="Editar item"><i class="fas fa-edit"></i></button>
                <button class="action-btn delete-asset-btn delete" aria-label="Remover item"><i class="fas fa-trash"></i></button>
            </td>
        `,e.assetList.appendChild(a)})}},w=t=>{e.assetModal&&(f=t.id,e.assetNameEditInput.value=t.name,e.assetPurchaseDateEditInput.value=t.purchaseDate,e.assetModal.style.display="flex")},E=()=>{e.assetModal&&(e.assetModal.style.display="none",f=null)},y=t=>{if(t.preventDefault(),!f)return;const n=i.findIndex(o=>o.id===f);if(n===-1)return;const s=e.assetNameEditInput.value.trim(),a=e.assetPurchaseDateEditInput.value;if(!s||!a){window.showToast("Nome do item e data são obrigatórios.","warning");return}i[n].name=s,i[n].purchaseDate=a,u.set(l.FINANCE_ASSETS,i),p(),E(),window.showToast("Item atualizado com sucesso!","success")},A=t=>{t.preventDefault();const n=e.assetNameInput.value.trim(),s=e.assetPurchaseDateInput.value;if(!n||!s){window.showToast("Por favor, preencha o nome e a data de compra do item.","warning");return}const a={id:Date.now().toString(),name:n,purchaseDate:s};i.push(a),u.set(l.FINANCE_ASSETS,i),p(),e.assetForm.reset()},F=async t=>{const n=t.target,s=n.closest("tr");if(!s||!s.dataset.id)return;const a=s.dataset.id,o=i.find(c=>c.id===a);if(!o)return;if(n.closest(".edit-asset-btn")){w(o);return}n.closest(".delete-asset-btn")&&await g(`Tem certeza que deseja remover "${o.name}" do planejamento?`)&&(i=i.filter(h=>h.id!==a),u.set(l.FINANCE_ASSETS,i),p(),window.showToast("Item removido do planejamento.","success"))},N=t=>{const s=t.target.closest(".add-to-plan-btn");if(!s)return;const a=s.closest(".routine-block");if(!a)return;const o=a.dataset.description,r=a.dataset.category;o&&r&&v(void 0,{description:o,category:r})};function b(){e.reflectionForm&&e.reflectionForm.addEventListener("submit",t=>{t.preventDefault();const n=e.reflectionForm.querySelectorAll(".reflection-input"),s=e.reflectionForm.dataset.category;let a=0;const o=u.get(l.UNIFIED_REFLECTIONS)||[];n.forEach(r=>{const d=r.value.trim();if(d){const c=new Date,h={id:`${c.getTime()}-${Math.random()}`,category:s,title:r.dataset.title||"Reflexão",text:d,date:c.toISOString().split("T")[0],timestamp:c.getTime()};o.push(h),r.value="",a++}}),a>0?(u.set(l.UNIFIED_REFLECTIONS,o),window.showToast(`${a} reflex${a>1?"ões salvas":"ão salva"} com sucesso!`,"success")):window.showToast("Nenhuma reflexão preenchida para salvar.","info")})}function C(){var s,a,o,r,d;const t=document.getElementById("page-financeira");if(!t)return;e.pageContainer=t,e.assetList=t.querySelector("#asset-replacement-list"),e.assetForm=t.querySelector("#add-asset-form"),e.assetNameInput=t.querySelector("#asset-name-input"),e.assetPurchaseDateInput=t.querySelector("#asset-purchase-date-input"),e.reflectionForm=t.querySelector(".reflection-form"),e.assetModal=document.getElementById("asset-modal"),e.assetModalForm=document.getElementById("asset-edit-form"),e.assetModalCloseBtn=document.getElementById("asset-modal-close-btn"),e.assetModalCancelBtn=document.getElementById("asset-modal-cancel-btn"),e.saveAssetEditBtn=document.getElementById("save-asset-edit-btn"),e.assetNameEditInput=document.getElementById("asset-name-edit-input"),e.assetPurchaseDateEditInput=document.getElementById("asset-purchase-date-edit-input");const n=t.querySelector("#do-action-hub");n==null||n.addEventListener("click",N),(s=e.assetForm)==null||s.addEventListener("submit",A),(a=e.assetList)==null||a.addEventListener("click",F),b(),(o=e.assetModalCloseBtn)==null||o.addEventListener("click",E),(r=e.assetModalCancelBtn)==null||r.addEventListener("click",E),(d=e.assetModalForm)==null||d.addEventListener("submit",y),m=new D("page-financeira",l.FINANCE_GOALS,"financeira-metas-list","financeira-metas-form","financeira-meta-input",S,"Financeira"),m.setup()}function x(){m==null||m.show();const t=u.get(l.FINANCE_ASSETS);t&&t.length>0?i=t:i=[{id:"default-1",name:"Notebook",purchaseDate:"2014-01-01"},{id:"default-2",name:"Geladeira",purchaseDate:"2015-01-01"},{id:"default-3",name:"Cama de casal",purchaseDate:"2015-01-01"},{id:"default-4",name:"Air fryer",purchaseDate:"2015-01-01"},{id:"default-5",name:"Lancheira",purchaseDate:"2015-01-01"},{id:"default-6",name:"Sofá",purchaseDate:"2025-01-01"},{id:"default-7",name:"Video game (PS2, PS3, PS4)",purchaseDate:"2018-01-01"},{id:"default-8",name:"Mesa escritório",purchaseDate:"2021-01-01"},{id:"default-9",name:"Mesas de apoio",purchaseDate:"2022-01-01"},{id:"default-10",name:"Banquetas vermelhas",purchaseDate:"2022-01-01"},{id:"default-11",name:"Cama de solteiro",purchaseDate:"2022-01-01"},{id:"default-12",name:"Fogão",purchaseDate:"2021-01-01"},{id:"default-13",name:"Televisão",purchaseDate:"2022-01-01"}],p()}export{C as setup,x as show};
