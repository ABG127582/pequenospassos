import{s as c,S as p,p as S,c as k}from"./main-sp5dYjpB.js";let r,l,m=null;const I={tasks:[{id:"1",startTime:"06:00",endTime:"06:30",description:"Acordar, Hidratação e Meditação",completed:!1,category:"Mental"},{id:"2",startTime:"06:30",endTime:"07:30",description:"Exercício Físico",completed:!1,category:"Física"},{id:"3",startTime:"07:30",endTime:"08:30",description:"Café da Manhã Nutritivo",completed:!1,category:"Preventiva"},{id:"4",startTime:"08:30",endTime:"09:00",description:"Planejar o Dia (Definir 3 Prioridades)",completed:!1,category:"Profissional"},{id:"5",startTime:"09:00",endTime:"10:30",description:"Bloco de Trabalho Focado 1",completed:!1,category:"Profissional"},{id:"6",startTime:"10:30",endTime:"10:45",description:"Pausa Curta (Café, Alongamento)",completed:!1,category:"Física"},{id:"7",startTime:"10:45",endTime:"12:00",description:"Bloco de Trabalho Focado 2",completed:!1,category:"Profissional"},{id:"8",startTime:"12:00",endTime:"13:00",description:"Almoço Consciente (Sem telas)",completed:!1,category:"Mental"},{id:"9",startTime:"13:00",endTime:"15:00",description:"Trabalho Focado ou Reuniões",completed:!1,category:"Profissional"},{id:"10",startTime:"15:00",endTime:"15:15",description:"Pausa para Meditação ou Respiração",completed:!1,category:"Mental"},{id:"11",startTime:"15:15",endTime:"17:00",description:"Tarefas Administrativas e E-mails",completed:!1,category:"Profissional"},{id:"12",startTime:"17:00",endTime:"17:30",description:"Ritual de Encerramento do Trabalho",completed:!1,category:"Mental"},{id:"13",startTime:"17:30",endTime:"19:00",description:"Tempo Livre / Hobby / Social",completed:!1,category:"Pessoal"},{id:"14",startTime:"19:00",endTime:"20:00",description:"Jantar e Conexão Familiar",completed:!1,category:"Familiar"},{id:"15",startTime:"20:00",endTime:"21:00",description:"Aprendizado (Leitura, Curso)",completed:!1,category:"Profissional"},{id:"16",startTime:"21:00",endTime:"22:00",description:"Relaxamento (Sem telas)",completed:!1,category:"Mental"},{id:"17",startTime:"22:00",endTime:"22:15",description:"Diário de Gratidão / Reflexão do Dia",completed:!1,category:"Espiritual"}],reflection:{sleep:"",dayReview:"",bodyScan:"",mentalCheck:"",premeditation:""}},e={pageContainer:null,dateInput:null,progressRing:null,progressText:null,scheduleList:null,addEventBtn:null,modal:null,modalTitle:null,modalForm:null,modalCloseBtn:null,modalCancelBtn:null,modalSaveBtn:null,modalDeleteBtn:null,modalDescriptionInput:null,modalStartTimeInput:null,modalEndTimeInput:null,modalCategorySelect:null},y=t=>`${p.DAILY_PLAN_PREFIX}${t}`,E=()=>{r||(r=c.get(p.DAILY_PLAN_LAST_DATE)||new Date().toISOString().split("T")[0]);const t=c.get(y(r));t&&t.tasks&&t.tasks.length>0?(l=t,(typeof l.reflection=="string"||!l.reflection)&&(l.reflection={sleep:"",dayReview:"",bodyScan:"",mentalCheck:"",premeditation:""})):l=JSON.parse(JSON.stringify(I))},f=()=>{c.set(y(r),l)},C=()=>{if(!e.progressRing||!e.progressText)return;const t=l.tasks.length;if(t===0){e.progressRing.style.strokeDashoffset="100",e.progressText.textContent="0%";return}const a=l.tasks.filter(s=>s.completed).length,o=Math.round(a/t*100);e.progressRing.style.strokeDashoffset=(100-o).toString(),e.progressText.textContent=`${o}%`},g=()=>{if(e.scheduleList){e.scheduleList.innerHTML="";for(let t=0;t<24;t++){const a=t.toString().padStart(2,"0"),o=document.createElement("li");o.className="hour-slot",o.dataset.hour=a;const s=l.tasks.filter(n=>n.startTime.startsWith(a+":")).sort((n,d)=>n.startTime.localeCompare(d.startTime));let i="";s.forEach(n=>{i+=`
                <div class="task-block ${n.completed?"completed":""}" data-task-id="${n.id}" data-category="${n.category}" tabindex="0">
                    <div class="task-content">
                        <div class="task-time-range">${n.startTime} - ${n.endTime}</div>
                        <p class="task-description">${S.sanitize(n.description)}</p>
                    </div>
                    <div class="task-block-actions">
                        <button class="action-btn complete-btn complete" aria-label="Marcar como concluída"><i class="fas fa-check"></i></button>
                    </div>
                </div>
            `}),o.innerHTML=`
            <div class="hour-label">${a}:00</div>
            <div class="tasks-in-hour">
                ${i||""}
            </div>
        `,e.scheduleList.appendChild(o)}C()}},v=()=>{E(),g()},T=(t,a,o)=>{!e.modal||!e.modalForm||!e.modalTitle||!e.modalDeleteBtn||(e.modalForm.reset(),m=t?t.id:null,t?(e.modalTitle.textContent="Editar Evento",e.modalDescriptionInput.value=t.description,e.modalStartTimeInput.value=t.startTime,e.modalEndTimeInput.value=t.endTime,e.modalCategorySelect.value=t.category,e.modalDeleteBtn.style.display="inline-flex"):(e.modalTitle.textContent="Adicionar Evento",e.modalStartTimeInput.value=o?`${o.padStart(2,"0")}:00`:"",e.modalEndTimeInput.value=o?`${(parseInt(o,10)+1).toString().padStart(2,"0")}:00`:"",e.modalDeleteBtn.style.display="none",a&&(e.modalDescriptionInput.value=a.description,e.modalCategorySelect.value=a.category)),e.modal.style.display="flex")},u=()=>{e.modal&&(e.modal.style.display="none")},D=t=>{t.preventDefault();const a=e.modalDescriptionInput.value.trim();if(!a){window.showToast("A descrição é obrigatória.","warning");return}const o={description:a,startTime:e.modalStartTimeInput.value,endTime:e.modalEndTimeInput.value,category:e.modalCategorySelect.value};if(m){const s=l.tasks.findIndex(i=>i.id===m);s>-1&&(l.tasks[s]={...l.tasks[s],...o})}else l.tasks.push({id:Date.now().toString(),completed:!1,...o});f(),g(),u(),window.showToast("Evento salvo no plano diário!","success")},L=async()=>{if(!m)return;await k("Tem certeza que deseja excluir este evento?")&&(l.tasks=l.tasks.filter(a=>a.id!==m),f(),g(),u(),window.showToast("Evento excluído.","success"))},b=()=>{e.dateInput&&(r=e.dateInput.value,c.set(p.DAILY_PLAN_LAST_DATE,r),v())},A=t=>{var i;const a=t.target,o=a.closest(".task-block"),s=a.closest(".tasks-in-hour");if(o){const n=o.dataset.taskId,d=l.tasks.find(h=>h.id===n);if(!d)return;a.closest(".complete-btn")?(d.completed=!d.completed,f(),g()):T(d)}else if(s){const n=(i=s.parentElement)==null?void 0:i.dataset.hour;T(void 0,void 0,n)}};function B(){var t,a,o,s,i,n,d;e.pageContainer=document.getElementById("page-planejamento-diario"),e.pageContainer&&(e.dateInput=e.pageContainer.querySelector("#daily-plan-date"),e.progressRing=e.pageContainer.querySelector("#daily-progress-ring .progress-ring-fg"),e.progressText=e.pageContainer.querySelector("#progress-ring-text"),e.scheduleList=e.pageContainer.querySelector("#schedule-hours-list"),e.addEventBtn=document.getElementById("add-event-btn"),e.modal=document.getElementById("schedule-task-modal"),e.modal&&(e.modalTitle=e.modal.querySelector("#schedule-task-modal-title"),e.modalForm=e.modal.querySelector("#schedule-task-form"),e.modalCloseBtn=e.modal.querySelector("#schedule-task-modal-close-btn"),e.modalCancelBtn=e.modal.querySelector("#schedule-task-modal-cancel-btn"),e.modalSaveBtn=e.modal.querySelector("#save-task-btn"),e.modalDeleteBtn=e.modal.querySelector("#delete-task-btn"),e.modalDescriptionInput=e.modal.querySelector("#task-description-input"),e.modalStartTimeInput=e.modal.querySelector("#task-start-time-input"),e.modalEndTimeInput=e.modal.querySelector("#task-end-time-input"),e.modalCategorySelect=e.modal.querySelector("#task-category-select")),(t=e.dateInput)==null||t.addEventListener("change",b),(a=e.addEventBtn)==null||a.addEventListener("click",()=>T()),(o=e.scheduleList)==null||o.addEventListener("click",A),e.modal&&!e.modal.dataset.handlerAttached&&((s=e.modalCloseBtn)==null||s.addEventListener("click",u),(i=e.modalCancelBtn)==null||i.addEventListener("click",u),(n=e.modalForm)==null||n.addEventListener("submit",D),(d=e.modalDeleteBtn)==null||d.addEventListener("click",L),e.modal.dataset.handlerAttached="true"))}function x(){!e.pageContainer||!e.dateInput||(r=c.get(p.DAILY_PLAN_LAST_DATE)||new Date().toISOString().split("T")[0],e.dateInput.value=r,v(),setTimeout(()=>{var o;const t=new Date().getHours(),a=(o=e.scheduleList)==null?void 0:o.querySelector(`[data-hour="${t.toString().padStart(2,"0")}"]`);a==null||a.scrollIntoView({behavior:"smooth",block:"center"})},200))}export{T as openModal,B as setup,x as show};
